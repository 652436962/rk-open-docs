# Rockchip Ficial Gate Instruction

文件标识：RK-SM-YF-329

发布版本：V2.0.1

日期：2020-05-21

文件密级：□绝密   □秘密   □内部资料   ■公开

---

**免责声明**

本文档按“现状”提供，福州瑞芯微电子股份有限公司（“本公司”，下同）不对本文档的任何陈述、信息和内容的准确性、可靠性、完整性、适销性、特定目的性和非侵权性提供任何明示或暗示的声明或保证。本文档仅作为使用指导的参考。

由于产品版本升级或其他原因，本文档将可能在未经任何通知的情况下，不定期进行更新或修改。

**商标声明**

“Rockchip”、“瑞芯微”、“瑞芯”均为本公司的注册商标，归本公司所有。

本文档可能提及的其他所有注册商标或商标，由其各自拥有者所有。

**版权所有** **© 2020** **福州瑞芯微电子股份有限公司**

超越合理使用范畴，非经本公司书面许可，任何单位和个人不得擅自摘抄、复制本文档内容的部分或全部，并不得以任何形式传播。

福州瑞芯微电子股份有限公司

Fuzhou Rockchip Electronics Co., Ltd.

地址：     福建省福州市铜盘路软件园A区18号

网址：     www.rock-chips.com

客户服务电话： +86-4007-700-590

客户服务传真： +86-591-83951833

客户服务邮箱： fae@rock-chips.com

---

## **前言**

 **概述**

 本文主要描述了ficial_gate应用各个模块的使用说明。ficial_gate应用基于librkfacial.so，具体接口参考《Rockchip_Instruction_Rkfacial_CN.pdf》，源代码和文档路径位于SDK/external/rkfacial。

**产品版本**

| **平台名称** | **内核版本** |
| ------------ | ------------ |
| Linux        | 4.4          |

**读者对象**

本文档（本指南）主要适用于以下工程师：

​        技术支持工程师

​        软件开发工程师

 **修订记录**

| **日期**   | **版本** | **作者**    | **修改说明**                 |
| ---------- | -------- | :---------- | ---------------------------- |
| 2020-02-11 | V0.0.1   | Zhihua Wang | 初始版本                     |
| 2020-02-24 | V0.0.2   | Zhihua Wang | 增加命令参数-i，-c说明       |
| 2020-03-10 | V1.0.0   | Zhihua Wang | 增加应用流程图               |
| 2020-04-29 | V1.0.1   | Zhihua Wang | 修改key.lic路径              |
| 2020-05-21 | V2.0.0   | Zhihua Wang | 拆分代码为ui和librkfacial.so |
| 2020-05-22 | V2.0.1   | Zhihua Wang | 增加rkfacial说明             |

---

## **目录**

[TOC]

---

## **1 整体介绍**

### **1.1 应用说明**

ficial_gate通过librkfacial.so利用RK自有算法rockface实现了人脸检测，人脸特征点提取，人脸识别，活体检测流程。

具体包含以下功能：

1. 获取RGB摄像头图像数据做人脸识别，获取IR摄像头图像数据做活体检测。
2. 使用SQLITE3作为数据库来存储人脸特征值和用户名。
3. 利用MiniGUI实现用户注册，删除注册数据，人脸框跟踪及用户名显示等操作。
4. 利用ALSA接口实现各流程语音播报功能。

注意： rockface的使用需要RK授权，请参考sdk/external/rockface/auth/README文档来申请授权。  

### **1.2 使用方法**

ficial_gate [-f num] [-e] [-i] [-c]

-f：表示人脸底库最大支持的数量，没有配置的情况下默认人脸底库最大支持1000张

-e：表示支持RGB摄像头人脸坐标局部曝光，没有配置默认不支持局部曝光

-i：表示使用ISP驱动上面的RGB摄像头

-c：表示使用CIF驱动上面的IR摄像头

示例：

使用ISP、CIF：ficial_gate -f 30000 -e -i -c，屏幕显示RGB图像，可以用于检测人脸，有活体结果

只使用ISP：ficial_gate -f 30000 -e -i，屏幕显示RGB图像，可以用于检测人脸，无活体结果

只是用CIF：ficial_gate -f 30000 -e -c，屏幕显示IR图像，可以用于调试活体算法

## **2 代码模块说明**

### **2.1 ui**

Register按键：实时注册摄像头采集到人脸特征值到数据库。

Delete按键：实时从数据库删除摄像头采集到人脸特征值。

人脸框：红色表示未注册到数据库，黄色表示已经注册到数据库但是不是活体，绿色表示已经注册到数据库而且是活体。